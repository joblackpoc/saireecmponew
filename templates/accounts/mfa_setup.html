{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}MFA Setup - {{ site_settings.site_name|default:"SaiReeCMPO" }}{% endblock %}

{% block content %}
<section id="mfa-setup-page" style="padding-top: 150px; min-height: 80vh;">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-md-offset-3">
                <div class="entry-form" style="margin-top: 0;">
                    <h2 class="text-center">Setup Two-Factor Authentication</h2>
                    <p class="text-center text-muted">Secure your account with Google Authenticator</p>
                    
                    <div class="row">
                        <div class="col-md-12">
                            <h4>Step 1: Scan QR Code</h4>
                            <p>Scan this QR code with your Google Authenticator app:</p>
                            <div class="text-center" style="margin: 20px 0;">
                                <img src="data:image/png;base64,{{ qr_code }}" alt="QR Code" style="border: 5px solid #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            </div>
                            
                            <p class="text-muted text-center">Or enter this secret key manually:</p>
                            <p class="text-center"><code style="font-size: 16px; padding: 10px; background: #f5f5f5;">{{ secret }}</code></p>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="row">
                        <div class="col-md-12">
                            <h4>Step 2: Verify Code</h4>
                            <p>Enter the 6-digit code from your authenticator app:</p>
                            
                            <form method="post">
                                {% csrf_token %}
                                {{ form|crispy }}
                                
                                <div class="form-group">
                                    <button type="submit" class="submit-btn form-control">Enable MFA</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <div class="text-center" style="margin-top: 20px;">
                        <a href="{% url 'accounts:profile' %}">Cancel</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
