{% extends 'dashboard/base.html' %}

{% block title %}Dashboard{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% block dashboard_content %}
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card stat-card primary">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <h6 class="text-muted mb-1">Blog Posts</h6>
                    <h3 class="mb-0">{{ total_posts }}</h3>
                </div>
                <div class="stat-icon">
                    <i class="fa fa-newspaper-o"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stat-card success">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <h6 class="text-muted mb-1">Downloads</h6>
                    <h3 class="mb-0">{{ total_downloads }}</h3>
                </div>
                <div class="stat-icon">
                    <i class="fa fa-download"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stat-card warning">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <h6 class="text-muted mb-1">My PDFs</h6>
                    <h3 class="mb-0">{{ total_pdfs }}</h3>
                </div>
                <div class="stat-icon">
                    <i class="fa fa-file-pdf-o"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stat-card danger">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <h6 class="text-muted mb-1">MFA Status</h6>
                    <h3 class="mb-0">
                        {% if user.mfa_enabled %}
                        <span class="text-success"><i class="fa fa-check"></i></span>
                        {% else %}
                        <span class="text-danger"><i class="fa fa-times"></i></span>
                        {% endif %}
                    </h3>
                </div>
                <div class="stat-icon">
                    <i class="fa fa-shield"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Recent Announcements</h5>
                <a href="{% url 'content:dashboard_announcement_list' %}" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for item in announcements %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>{{ item.title|truncatewords:8 }}</span>
                        <small class="text-muted">{{ item.published_date|date:"d M" }}</small>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-muted">No announcements yet</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Recent Activities</h5>
                <a href="{% url 'content:dashboard_activity_list' %}" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for item in activities %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>{{ item.title|truncatewords:8 }}</span>
                        <small class="text-muted">{{ item.event_date|date:"d M" }}</small>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-muted">No activities yet</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Recent Blog Posts</h5>
                <a href="{% url 'blog:dashboard_list' %}" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for post in recent_posts %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>{{ post.title|truncatewords:8 }}</span>
                        <span>
                            {% if post.is_published %}
                            <span class="badge bg-success">Published</span>
                            {% else %}
                            <span class="badge bg-secondary">Draft</span>
                            {% endif %}
                        </span>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-muted">No blog posts yet</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">My PDF Documents</h5>
                <a href="{% url 'pdfapp:list' %}" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for pdf in recent_pdfs %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>{{ pdf.title|truncatewords:8 }}</span>
                        <span>
                            {% if pdf.status == 'completed' %}
                            <span class="badge bg-success">Completed</span>
                            {% elif pdf.status == 'processing' %}
                            <span class="badge bg-warning">Processing</span>
                            {% else %}
                            <span class="badge bg-secondary">{{ pdf.status }}</span>
                            {% endif %}
                        </span>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-muted">No PDF documents yet</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Quick Actions</h5>
            </div>
            <div class="card-body">
                <a href="{% url 'content:dashboard_announcement_add' %}" class="btn btn-primary me-2">
                    <i class="fa fa-plus"></i> New Announcement
                </a>
                <a href="{% url 'blog:dashboard_add' %}" class="btn btn-primary me-2">
                    <i class="fa fa-plus"></i> New Blog Post
                </a>
                <a href="{% url 'download:dashboard_add' %}" class="btn btn-primary me-2">
                    <i class="fa fa-upload"></i> Upload File
                </a>
                <a href="{% url 'pdfapp:upload' %}" class="btn btn-primary">
                    <i class="fa fa-file-pdf-o"></i> Convert to PDF
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
